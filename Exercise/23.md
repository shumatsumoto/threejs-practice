## 1. 問題タイトル

23 本目：キーボード操作でオブジェクト移動

## 2. 学習目標

この演習を通じて、以下の技術を習得します。

- `keydown` イベントの取得
- キーコード（`ArrowUp`, `KeyW` など）による条件分岐
- ユーザー入力によるオブジェクト制御

## 3. 新しい概念の解説

**Event Listener（イベントリスナー）**
ユーザーの操作（キーを押した、マウスを動かしたなど）を検知する仕組みです。
`window.addEventListener("keydown", func)` を使うことで、キーが押された瞬間に特定の関数を実行できます。

**Key Code**
どのキーが押されたかを識別するコードです。
`ArrowUp`（上矢印）、`KeyW`（Wキー）、`Space`（スペース）など、物理的なキー配置に基づいたコードが割り当てられています。

```javascript
window.addEventListener('keydown', (event) => {
    // 押されたキーのコードを確認
    switch(event.code) {
        case 'ArrowUp':
            cube.position.y += 0.1;
            break;
        case 'Space':
            console.log('Space key pressed');
            break;
    }
});
```

## 4. 課題の説明

キーボードの矢印キー（↑↓←→）を使って、キューブを上下左右に移動できるようにしてください。
ゲームのようなキャラクター操作の基本となります。

## 5. 必須要件

以下の機能を実装してください。

- **キー入力の検知**:
  `window.addEventListener('keydown', ...)` を設定します。
  コールバック関数内で `event.code`（または `event.key`）を確認します。

- **移動の実装**:
  - `ArrowUp` (↑): Y座標を `+0.1`
  - `ArrowDown` (↓): Y座標を `-0.1`
  - `ArrowRight` (→): X座標を `+0.1`
  - `ArrowLeft` (←): X座標を `-0.1`

- **動作確認**:
  キーを押すとキューブが画面上で上下左右に移動することを確認します。

## 6. ヒント

- **ヒント 1（イベントリスナー）**:
  `window.addEventListener('keydown', (e) => { ... })` を使います。
  一度だけ登録すれば、キーを押すたびに中の関数が実行されます。
- **ヒント 2（座標系）**:
  Three.js の標準では `y` が上、`x` が横ですが、床（Plane）の上を移動させるゲームなら `z`（前後）と `x`（左右）を使うこともあります。
  今回は空中に浮いているので `x, y` で OK です。
- **ヒント 3（変数化）**:
  移動スピード `const speed = 0.1;` のように変数にしておくと、後で調整しやすくなります。
- **ヒント 4（Switch文）**:
  `if (e.code === 'ArrowUp') ... else if ...` と書いても良いですが、`switch (e.code)` を使うとコードが見やすくなります。
- **ヒント 5（キーコード）**:
  主なコードは `ArrowUp`, `ArrowDown`, `ArrowLeft`, `ArrowRight`, `Space`, `Enter`, `KeyW`, `KeyA` などです。
  開発者ツールのコンソールで `console.log(e.code)` して確認すると確実です。

## 7. スターターコード

```javascript
import * as THREE from "three";

const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(
  75,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const geometry = new THREE.BoxGeometry(1, 1, 1);
const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const cube = new THREE.Mesh(geometry, material);
scene.add(cube);

camera.position.z = 5;

// --- ここでキーボードイベントを処理してください ---

function animate() {
  requestAnimationFrame(animate);
  renderer.render(scene, camera);
}
animate();
```

## 8. 模範解答

```javascript
import * as THREE from "three";

const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(
  75,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const geometry = new THREE.BoxGeometry(1, 1, 1);
const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const cube = new THREE.Mesh(geometry, material);
scene.add(cube);

camera.position.z = 5;

window.addEventListener("keydown", (event) => {
  const speed = 0.1;

  switch (event.code) {
    case "ArrowUp":
      cube.position.y += speed;
      break;
    case "ArrowDown":
      cube.position.y -= speed;
      break;
    case "ArrowRight":
      cube.position.x += speed;
      break;
    case "ArrowLeft":
      cube.position.x -= speed;
      break;
  }
});

function animate() {
  requestAnimationFrame(animate);
  renderer.render(scene, camera);
}
animate();
```
